<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title></title>
  <style>
*{
  margin: 0;
  padding: 0;
}
body{
  background: #2d2c41;
}
#table{
  border: 1px solid;
  background: #aaa;
  display: inline-block;
  margin: 50px 200px;
  position: relative;
  left: 300px;
  top: -250px;
}
.item{
  display: inline-block;
  width: 50px;
  height: 50px;
  margin: 1px;
  background: #fff;
}
#command{
  width: 350px;
  background: #0aa;
  text-align: center;
  float: inline-block;
  margin: 50px 50px;
  position: relative;
}
input{
  font-size: 16px;
  height: 30px;
}
input[type=button]{
  font-weight: bold;
  background: #0ddcaa;
  box-shadow: 3px 3px 0 0 #03f;
  color: #fff;
  border-radius: 5px;
  border: none;
  margin: 3px;
  position: relative;
}
input[type=button]:active{
  box-shadow: 2px 2px 0 0 #3f;
  top: 1px;
  left: 1px;
}
#box{
  transition: all 1s;
  width: 40px;
  height: 50px;
  position: absolute;
  top: 1px;
  left: 1px;
  background: #e55;
  border-left: 10px solid #00a;
}
  </style>
</head>
<body>
<div id=command>
  <input type="text">
  <input type=button value='执行'>
  <br>
  <input type=button value=TUNLEF>
  <input type=button value=TUNRIG>
  <input type=button value=TUNBAC>
  <input type=button value=GO>
  <br>
  <input type=button value=TRALEF>
  <input type=button value=TRARIG>
  <input type=button value=TRATOP>
  <input type=button value=TRABOT>
  <br>
  <input type=button value=MOVLEF>
  <input type=button value=MOVRIG>
  <input type=button value=MOVTOP>
  <input type=button value=MOVBOT>
</div>
<div id=table>
<div id="box"></div>
<div class="row">
  <div class="item"></div>
  <div class="item"></div>
  <div class="item"></div>
  <div class="item"></div>
  <div class="item"></div>
  <div class="item"></div>
  <div class="item"></div>
  <div class="item"></div>
  <div class="item"></div>
  <div class="item"></div>
</div>
<div class="row">
  <div class="item"></div>
  <div class="item"></div>
  <div class="item"></div>
  <div class="item"></div>
  <div class="item"></div>
  <div class="item"></div>
  <div class="item"></div>
  <div class="item"></div>
  <div class="item"></div>
  <div class="item"></div>
</div>
<div class="row">
  <div class="item"></div>
  <div class="item"></div>
  <div class="item"></div>
  <div class="item"></div>
  <div class="item"></div>
  <div class="item"></div>
  <div class="item"></div>
  <div class="item"></div>
  <div class="item"></div>
  <div class="item"></div>
</div>
<div class="row">
  <div class="item"></div>
  <div class="item"></div>
  <div class="item"></div>
  <div class="item"></div>
  <div class="item"></div>
  <div class="item"></div>
  <div class="item"></div>
  <div class="item"></div>
  <div class="item"></div>
  <div class="item"></div>
</div>
<div class="row">
  <div class="item"></div>
  <div class="item"></div>
  <div class="item"></div>
  <div class="item"></div>
  <div class="item"></div>
  <div class="item"></div>
  <div class="item"></div>
  <div class="item"></div>
  <div class="item"></div>
  <div class="item"></div>
</div>
<div class="row">
  <div class="item"></div>
  <div class="item"></div>
  <div class="item"></div>
  <div class="item"></div>
  <div class="item"></div>
  <div class="item"></div>
  <div class="item"></div>
  <div class="item"></div>
  <div class="item"></div>
  <div class="item"></div>
</div>
<div class="row">
  <div class="item"></div>
  <div class="item"></div>
  <div class="item"></div>
  <div class="item"></div>
  <div class="item"></div>
  <div class="item"></div>
  <div class="item"></div>
  <div class="item"></div>
  <div class="item"></div>
  <div class="item"></div>
</div>
<div class="row">
  <div class="item"></div>
  <div class="item"></div>
  <div class="item"></div>
  <div class="item"></div>
  <div class="item"></div>
  <div class="item"></div>
  <div class="item"></div>
  <div class="item"></div>
  <div class="item"></div>
  <div class="item"></div>
</div>
<div class="row">
  <div class="item"></div>
  <div class="item"></div>
  <div class="item"></div>
  <div class="item"></div>
  <div class="item"></div>
  <div class="item"></div>
  <div class="item"></div>
  <div class="item"></div>
  <div class="item"></div>
  <div class="item"></div>
</div>
<div class="row">
  <div class="item"></div>
  <div class="item"></div>
  <div class="item"></div>
  <div class="item"></div>
  <div class="item"></div>
  <div class="item"></div>
  <div class="item"></div>
  <div class="item"></div>
  <div class="item"></div>
  <div class="item"></div>
</div>
</div>
<script>
var directions = ['left','top','right','bottom'];
// 随机初始化位置与方向
var row = Math.floor(Math.random() * 10);
var col = Math.floor(Math.random() * 10);
var dir = 0;
var step = 56;
var deg = 0;

var box = document.getElementById('box');
box.style.left = 1 + col*step + 'px';
box.style.top = 1 + row*step + 'px';

// 移动
function go(e){
  n = dir;
  // 碰撞检测
  if( (dir === 0 && col <= 0) || (dir === 2 && col >= 9) ||(dir === 1 && row <= 0) ||(dir === 3 && row >= 9) ){
    alert('撞墙了！');
    return;
  }
  var box = document.getElementById('box');
  if (n === 0){
    box.style.left = parseInt(box.style.left) - step + 'px';
    col -= 1;
  }
  else if(n === 1){
    box.style.top = parseInt(box.style.top) - step + 'px';
    row -= 1;
  }
  else if(n === 2){
    box.style.left = parseInt(box.style.left) + step + 'px';
    col += 1;
  }
  else if(n === 3){
    box.style.top = parseInt(box.style.top) + step + 'px';
    row += 1;
  }
}

// 转向
function tun(n){
  document.getElementById('box').style.transform = 'rotate(' + (n*90 + deg) + 'deg)';
  dir = (dir+n)%4;
  deg = (deg+n*90)%360;
} 
function tunrig(e){
  tun(1);
}
function tunbac(e){
  tun(2);
}
function tunlef(e){
  tun(3);
}

// 不转向改方向前进
function tra(n){
  var _dir = dir;
  dir = n;
  go();
  dir = _dir;
}
function tralef(e){
  if(col <= 0){
    console.log('撞墙了！');
    return;
  }
  tra(0);
}
function trarig(e){
  if(col >= 9){
    console.log('撞墙了！');
    return;
  }
  tra(2);
}
function tratop(e){
  if(row <= 0){
    console.log('撞墙了！');
    return;
  }
  tra(1);
}
function trabot(e){
  if(row >= 9){
    console.log('撞墙了！');
    return;
  }
  tra(3);
}

// 转向加移动
function mov(n){
  dir = n;
  deg = n*90;
  document.getElementById('box').style.transform = 'rotate(' + deg + 'deg)';
  go();
}
function movlef(e){
  mov(0);
}
function movrig(e){
  mov(2);
}
function movtop(e){
  mov(1);
}
function movbot(e){
  mov(3);
}

var cmd = document.getElementsByTagName('input');
cmd[2].onclick = tunlef;
cmd[3].onclick = tunrig;
cmd[4].onclick = tunbac;
cmd[5].onclick = go;
cmd[6].onclick = tralef;
cmd[7].onclick = trarig;
cmd[8].onclick = tratop;
cmd[9].onclick = trabot;
cmd[10].onclick = movlef;
cmd[11].onclick = movrig;
cmd[12].onclick = movtop;
cmd[13].onclick = movbot;
cmd[1].onclick = function(e){
  var value = document.getElementsByTagName('input')[0].value;
  if (value === 'GO') go();
  else if(value === 'TUN LEF') tunlef();
  else if(value === 'TUN RIG') tunrig();
  else if(value === 'TUN BAC') tunbac();
  else if(value === 'TRA LEF') tralef();
  else if(value === 'TRA RIG') trarig();
  else if(value === 'TRA TOP') tratop();
  else if(value === 'TRA BOT') trabot();
  else if(value === 'MOV LEF') movlef();
  else if(value === 'MOV RIG') movrig();
  else if(value === 'MOV TOP') movtop();
  else if(value === 'MOV BOT') movbot();
  else{
    alert('您输入的命令不对！');
  }
}
</script>
</body>
</html>
